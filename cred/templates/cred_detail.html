{% extends "base.html" %}
{% load future %}

{% block content %}
{% if delete %}
<div class="alert alert-error">Deleting this password will delete all audit logs for this password</div>
{% endif %}
<table class="table table-striped table-bordered table-condensed">
<tr><th>Title</th><td>{{ cred.title }}</td></tr>
<tr><th>Group</th><td><a href="/staff/groupdetail/{{ cred.group.id}}/">{{ cred.group.name }}</a></td></tr>
<tr><th>Username</th><td>{{ cred.username }}</td></tr>
<tr><th>Password</th><td><span id="password">{{ cred.password }}</span></td></tr>
<tr><th>Last Change</th><td>{{ lastchange.time }}</td></tr>
</table>
<strong>Description:</strong>
<pre>
{{ cred.description }}
</pre>
{% if delete %}
    <form action="{{ action }}" method="post">{% csrf_token %}
        <input type="submit" class="btn btn-danger" value="Delete forever" />
    </form>
{% else %}
    <a class="btn btn-primary" href="/">Back</a>
    <a class="btn" href="/cred/edit/{{ cred.id }}/">Edit</a>
    <a class="btn" href="/cred/addtoqueue/{{ cred.id }}/">Add to Change Queue</a>
    {% if credlogs %}
        <h2>Audit Logs</h2>
        <table class="table table-striped table-bordered table-condensed">
        <tr><th>Action</th><th>User</th><th>When</th></tr>
        {% for audit in credlogs %}
          <tr><td>{{ audit.get_audittype_display }}</td><td>{{ audit.user.username }}</td><td>{{ audit.time }}</td></tr>
        {% endfor %}
	<tr><td colspan="3"><a href="{% url "staff.views.audit_by_cred" cred.id %}">More logs...</a></td></tr>
        </table>
    {% endif %}
{% endif %}
{% endblock %}
